{"version":3,"sources":["infinite-scroll.min.js"],"names":["root","factory","define","amd","exports","module","InfiniteScroll","this","options","eventEmitter","autoLoad","currentPage","finished","itemSelector","item","nextSelector","next","requestConfig","context","dataType","updatePagination","$","waitForImages","listener","Listener","activeZone","callback","load","emit","bind","prototype","ajax","then","data","$data","$items","find","$pagination","imagesReady","postLoad","items","page","that","start","stop","pagination","length","url","attr"],"mappings":"CAAE,SAASA,EAAMC,GACO,kBAAXC,SAAyBA,OAAOC,IACzCD,UAAWD,GACiB,gBAAZG,SAChBC,OAAOD,QAAUH,IAEjBD,EAAKM,eAAiBL,KAExBM,KAAM,WACR,YAeA,SAASD,GAAeE,GACtBC,cAAc,aAAc,aAAc,YAAaF,MAEvDA,KAAKG,SAAWF,EAAQE,YAAa,EAErCH,KAAKI,YAAc,EAEnBJ,KAAKK,UAAW,EAEhBL,KAAKM,aAAeL,EAAQM,KAC5BP,KAAKQ,aAAeP,EAAQQ,KAE5BT,KAAKU,eACHC,QAASX,KACTY,SAAU,QAGZZ,KAAKa,iBAAiBC,EAAEd,KAAKQ,eAE7BR,KAAKe,gBAAkBd,EAAQc,cAE/Bf,KAAKgB,SAAW,GAAIC,WAClBC,WAAYjB,EAAQiB,YAAc,IAClCC,SAAU,WACJnB,KAAKG,SACPH,KAAKoB,OAGLpB,KAAKqB,KAAK,eAEZC,KAAKtB,QAmFX,MA9EAD,GAAewB,WAKbH,KAAO,WACL,MAAIpB,MAAKK,SAAT,QAEAL,KAAKqB,KAAK,cAEHP,EAAEU,KAAKxB,KAAKU,eAChBe,KAAK,SAASC,GACb,GAAIC,GAAQb,EAAE,QAAUY,EAAO,UAC3BE,EAASD,EAAME,KAAK7B,KAAKM,cACzBwB,EAAcH,EAAME,KAAK7B,KAAKQ,aAElCmB,GAAQ,KAER3B,KAAKa,iBAAiBiB,GAElB9B,KAAKe,cACPa,EAAOG,cACJN,KAAKzB,KAAKgC,SAASV,KAAKtB,OAG3BA,KAAKgC,SAASJ,OAStBI,SAAW,SAASC,GAClB,GAAIP,IAAQO,MAAOA,EAAOC,KAAMlC,KAAKI,aACjC+B,EAAOnC,IAEXA,MAAKqB,KAAK,WAAYK,EAAM,WAC1BS,EAAKC,WAQTA,MAAQ,WACDpC,KAAKK,UACRL,KAAKgB,SAASoB,SAQlBC,KAAO,WACLrC,KAAKgB,SAASqB,QAOhBxB,iBAAmB,SAASyB,GAC1BtC,KAAKI,cAEDkC,EAAWC,OACbvC,KAAKU,cAAc8B,IAAMF,EAAWG,KAAK,QAGzCzC,KAAKK,UAAW,IAMfN","file":"infinite-scroll.min.js","sourcesContent":[";(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.InfiniteScroll = factory();\n  }\n}(this, function() {\n'use strict';\n\n\n/**\n * @name InfiniteScroll\n * @constructor\n *\n * @param {{}}      options\n * @param {boolean} [options.autoLoad=true]\n * @param {string}  options.item\n * @param {string}  options.next\n * @param {number}  [options.activeZone=200]\n * @param {boolean} [options.waitForImages=false]\n *\n */\nfunction InfiniteScroll(options) {\n  eventEmitter(['load:ready', 'load:start', 'load:end'], this);\n\n  this.autoLoad = options.autoLoad !== false;\n\n  this.currentPage = 0;\n\n  this.finished = false;\n\n  this.itemSelector = options.item;\n  this.nextSelector = options.next;\n\n  this.requestConfig = {\n    context: this,\n    dataType: 'html'\n  };\n\n  this.updatePagination($(this.nextSelector));\n\n  this.waitForImages = !!options.waitForImages;\n\n  this.listener = new Listener({\n    activeZone: options.activeZone || 200,\n    callback: function(){\n      if (this.autoLoad) {\n        this.load();\n      }\n      else {\n        this.emit('load:ready');\n      }\n    }.bind(this)\n  });\n}\n\n\nInfiniteScroll.prototype = {\n\n  /**\n   * Load the next available page.\n   */\n  load : function() {\n    if (this.finished) return;\n\n    this.emit('load:start');\n\n    return $.ajax(this.requestConfig)\n      .then(function(data){\n        var $data = $('<div>' + data + '</div>'),\n            $items = $data.find(this.itemSelector),\n            $pagination = $data.find(this.nextSelector);\n\n        $data = null;\n\n        this.updatePagination($pagination);\n\n        if (this.waitForImages) {\n          $items.imagesReady()\n            .then(this.postLoad.bind(this));\n        }\n        else {\n          this.postLoad($items);\n        }\n      });\n  },\n\n\n  /**\n   * @param {jQuery} items\n   */\n  postLoad : function(items) {\n    var data = {items: items, page: this.currentPage},\n        that = this;\n\n    this.emit('load:end', data, function(){\n      that.start();\n    });\n  },\n\n\n  /**\n   * Start infinite-scroll.\n   */\n  start : function() {\n    if (!this.finished) {\n      this.listener.start();\n    }\n  },\n\n\n  /**\n   * Stop infinite-scroll.\n   */\n  stop : function() {\n    this.listener.stop();\n  },\n\n\n  /**\n   * @param {jQuery} pagination\n   */\n  updatePagination : function(pagination) {\n    this.currentPage++;\n\n    if (pagination.length) {\n      this.requestConfig.url = pagination.attr('href');\n    }\n    else {\n      this.finished = true;\n    }\n  }\n\n};\n\nreturn InfiniteScroll;\n}));\n"],"sourceRoot":"/source/"}