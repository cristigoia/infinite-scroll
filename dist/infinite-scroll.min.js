/* infinite-scroll v0.2.0 - 2015-06-26T00:15:41.802Z - https://github.com/r-park/infinite-scroll */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.InfiniteScroll=e()}(this,function(){"use strict";function t(t,i){if(i)for(var n,r=Object.keys(h),s=r.length;s--;)n=r[s],i[n]=h[n];else i=Object.create(h);return i._events=e(t),i}function e(t){var e={};if("string"==typeof t)e[t]=[];else{if(!Array.isArray(t)||!t.length)throw new TypeError("EventEmitter : `eventTypes` is required");for(var i=0,n=t.length;n>i;++i)e[t[i]]=[]}return e}function i(t){for(var e=t.length,i=new Array(e);e--;)i[e]=t[e];return i}function n(t,e){for(var i=t.length;i--;)if(e===t[i].fn)return i;return-1}function r(t,e){for(var i=e,n=i+1,r=t.length;r>n;++i,++n)t[i]=t[n];t.pop()}function s(t){this.buffer=t.buffer||150,this.callback=t.callback,this.watching=!1,this.listener=function(){this.validate()&&(this.stop(),this.callback())}.bind(this)}function o(e){t(["load:start","load:end","end"],this),this.autoLoad=e.autoLoad!==!1,this.container=$(e.container),this.finished=!1,e.inject&&(this.inject=e.inject),this.item=e.item,this.pagination=e.pagination,this.requestConfig={context:this,dataType:"html",url:$(this.pagination).attr("href")},this.waitForImages=!!e.waitForImages,this.watcher=new s({buffer:e.scrollBuffer,callback:function(){this.autoLoad&&this.load()}.bind(this)})}var h={};return h.on=h.addListener=function(t,e,i,r){if("function"!=typeof e)throw new TypeError;var s=this._getListeners(t);if(s.length&&-1!==n(s,e))throw new Error;if(i===!0||r===!0){var o=this,h=!1;s.push({fn:function a(n){o.removeListener(t,a),h||(h=!0,e.call(i||{},n))},scope:{}})}else s.push({fn:e,scope:i||{}});return this},h.emit=function(t,e){var n=this._getListeners(t);if(n.length){n=i(n);for(var r,s=0,o=n.length;o>s;++s)r=n[s],r.fn.call(r.scope,e)}return this},h.removeListener=function(t,e){var i,s=this._getListeners(t);return s.length&&(i=n(s,e),-1!==i&&r(s,i)),this},h.removeAllListeners=function(t){if("string"==typeof t){var e=this._getListeners(t);e.length=0}else if("undefined"==typeof t){var i=this._events;for(var n in i)i[n].length=0}return this},h.listeners=function(t){var e=this._getListeners(t);return e.length?i(e):[]},h.listenerCount=function(t){var e=this._getListeners(t);return e.length},h._getListeners=function(t){var e=this._events[t];if(!e)throw new Error("EventEmitter : event type `"+t+"` does not exist");return e},s.prototype={start:function(){this.watching||(this.validate()?this.callback():(this.watching=!0,window.addEventListener("scroll",this.listener)))},stop:function(){window.removeEventListener("scroll",this.listener),this.watching=!1},validate:function(){return window.innerHeight+window.pageYOffset>=document.body.scrollHeight-this.buffer}},o.prototype={inject:function(t){t&&this.container.append(t)},load:function(){return this.finished?void 0:(this.emit("load:start"),$.ajax(this.requestConfig).then(this.process))},process:function(t){var e=$("<div>"+t+"</div>"),i=e.find(this.item);this.updatePagination(e),this.waitForImages?i.imagesReady().then(function(){this.emit("load:end"),this.inject(i),this.start()}.bind(this)):(this.emit("load:end"),this.inject(i),this.start())},start:function(){this.finished||this.watcher.start()},stop:function(){this.watcher.stop()},updatePagination:function(t){var e=t.find(this.pagination);e.length?this.requestConfig.url=e.attr("href"):(this.finished=!0,this.emit("end"))}},o});
//# sourceMappingURL=infinite-scroll.min.js.map